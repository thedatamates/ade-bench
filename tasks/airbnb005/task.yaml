task_id: airbnb005
status: ready
description: Create an NPS model.
notes: |-
prompts:
  - key: base
    prompt: |-
      Create two NPS score tables for reviews using sentiment to determine promoters or detractors. Create these tables and columns:

      daily_agg_nps_reviews
      - review_date
      - nps_daily
      - reviews_daily
      - nps_28d (rolling 28 day aggregation)
      - reviews_28d (rolling 28 day total)

      listing_agg_nps_reviews
      - listing_id
      - listing_name
      - room_type
      - nps_total
      - reviews_total
author_name: test
author_email: test
difficulty: medium
category: data-transformation
tags:
  - dbt
  - macros
timeout_seconds: 500

# Tables to compare for solution
solution_seeds:
  - table_name: daily_agg_nps_reviews
    exclude_tests:
      - equality_test
  - table_name: listing_agg_nps_reviews
    exclude_tests:
      - equality_test

# Variants for different database and project combinations
variants:
- db_type: duckdb
  db_name: airbnb
  project_type: dbt
  project_name: airbnb

- db_type: snowflake
  db_name: airbnb
  project_type: dbt
  project_name: airbnb
  migration_directory: airbnb__duckdb_to_snowflake

- db_type: snowflake
  db_name: airbnb
  project_type: dbt-fusion
  project_name: airbnb
  migration_directory: airbnb__duckdb_to_snowflake_dbtf