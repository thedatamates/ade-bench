task_id: electricity_consumption001
status: dev
description: Create a model that produces hourly rates for each retailer and plan combination
prompts:
  - key: base
    prompt: |-
      Create a new dbt model on top of the rate_plans seed called `hourly_rates`. It needs the rate for each hour and day of the week (Monday - Sunday) for each retailer + plan combination.

      Make sure it includes the following columns:
      - retailer
      - plan_name
      - day_of_week
      - hour (0-23)
      - price_per_kwh
      - daily_charge
      
      Each row should represent one hour of one day for one retailer/plan combo. The model should respect the start_hour, end_hour, applies_weekday, and applies_weekend columns.

  - key: minimal_instructions
    prompt: |-
      Create a new dbt model on top of the rate_plans seed called `hourly_rates`. It needs the rate for each hour and day of the week (Monday - Sunday) for each retailer + plan combination.
      
author_name: Joel Labes
author_email: joel@example.com
difficulty: medium
tags:
  - dbt
  - data-transformation
  - seed-data
  - cross-join

test_setup: |-
  dbt seed

solution_seeds:
  - table_name: hourly_rates

variants:
- db_type: duckdb
  db_name: electricity_consumption
  project_type: dbt
  project_name: electricity_consumption
