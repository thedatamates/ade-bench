task_id: f1003
status: dev
title: Add new stats models based on yml config
notes: |-
  Fixing the issue noted in f1002.
descriptions:
  - key: base
    description: |-
      Someone noticed that the results in the "most_fastest_laps" model are inconsistent, and that model doesn't always return the same top 20 drivers. Can you figure out why this is?
      One obvious solution would be order by some arbitrary column, but that doesn't seem like a good solution. 
author_name: test
author_email: test
difficulty: hard
category: model-creation
tags:
  - dbt
timeout_seconds: 500
parser_name: dbt
db_type: duckdb

# Tables to compare for solution
solution_seeds:
  - table_name: finishes_by_driver
  - table_name: most_podiums
    exclude_columns:
    - driver_full_name
  - table_name: most_pole_positions
    exclude_columns:
    - driver_full_name
  - table_name: most_fastest_laps
    exclude_columns:
    - driver_full_name

# Use shared database instead of local data files
database:
  source: shared
  name: f1
  type: duckdb

# Use shared project instead of local project
project:
  source: shared
  name: f1
  type: dbt