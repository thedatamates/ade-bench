task_id: f1003
status: ready
title: Add new stats models based on yml config
notes: |-
  Fixing the issue noted in f1002.
descriptions:
  - key: base
    description: |-
      Someone noticed that the results in the "most_fastest_laps" model are inconsistent, and that model doesn't always return the same top 20 drivers. Can you figure out why this is?

      When you find the issue, fix it so that:
      - It always returns the same top drivers
      - It does not return an arbitrary driver when there are ties
      - If the issue is in other models, fix those too.
author_name: test
author_email: test
difficulty: hard
category: model-creation
tags:
  - dbt
timeout_seconds: 500
parser_name: dbt

# Test setup script to run before dbt tests
test_setup: |-
  dbt run

# Tables to compare for solution
solution_seeds:
  - table_name: most_fastest_laps
  - table_name: most_laps
  - table_name: most_podiums
  - table_name: most_pole_positions
  - table_name: most_races
  - table_name: most_retirements
  - table_name: most_wins
  - table_name: oldest_race_winners_in_modern_era
    exclude_columns:
    - rank

# Variants for different database and project combinations
variants:
- db_type: duckdb
  db_name: f1
  project_type: dbt
  project_name: f1

- db_type: snowflake
  db_name: f1
  project_type: dbt
  project_name: f1
  migration_directory: f1__duckdb_to_snowflake