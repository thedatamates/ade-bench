task_id: quickbooks001
status: ready
description: Fix a data type issue where date columns are stored as unix timestamps, not the datetimes expected by the Fivetran package.
notes: |-
  The source tables have date columns (transaction_date, due_date) stored as unix epoch integers instead of proper datetime values. The solution requires overriding the Fivetran staging models to convert the epochs back to dates.
prompts:
  - key: base
    prompt: |-
      This project is erroring out and needs to be fixed. Fix the underlying issue and update the tables.
author_name: test
author_email: test
difficulty: easy
tags:
  - data-hygiene
  - data-inspection
  - dbt
  - dbt-packages
  - dbt-utils
  - debugging
  - model-refactor

test_setup: |-
  DBT_STATIC_ANALYSIS=off dbt run

# Tables to compare for solution
solution_seeds:
  - table_name: int_quickbooks__refund_receipt_transactions
  - table_name: int_quickbooks__sales_receipt_transactions
  - table_name: int_quickbooks__invoice_join
    exclude_columns:
    - source_relation

# Variants for different database and project combinations
variants:
- db_type: duckdb
  db_name: quickbooks
  project_type: dbt
  project_name: quickbooks

- db_type: snowflake
  db_name: quickbooks
  project_type: dbt
  project_name: quickbooks
  migration_directory: quickbooks__duckdb_to_snowflake

- db_type: snowflake
  db_name: quickbooks
  project_type: dbt-fusion
  project_name: quickbooks
  migration_directory: quickbooks__duckdb_to_snowflake_dbtf